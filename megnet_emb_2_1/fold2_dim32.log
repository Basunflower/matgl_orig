2024-04-26 22:05:36 INFO     Initialized benchmark 'matbench_v0.1' with 6 tasks: 
['matbench_jdft2d',
 'matbench_phonons',
 'matbench_dielectric',
 'matbench_log_gvrh',
 'matbench_log_kvrh',
 'matbench_perovskites']
2024-04-26 22:05:36 INFO     Loading dataset 'matbench_jdft2d'...
2024-04-26 22:05:36 INFO     Dataset 'matbench_jdft2d loaded.
  0%|          | 0/509 [00:00<?, ?it/s] 10%|█         | 53/509 [00:00<00:00, 529.27it/s] 26%|██▌       | 133/509 [00:00<00:00, 679.27it/s] 42%|████▏     | 214/509 [00:00<00:00, 738.14it/s] 58%|█████▊    | 297/509 [00:00<00:00, 770.19it/s] 74%|███████▍  | 379/509 [00:00<00:00, 787.74it/s] 90%|████████▉ | 458/509 [00:00<00:00, 737.36it/s]100%|██████████| 509/509 [00:00<00:00, 735.63it/s]
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Missing logger folder: matbench_jdft2d_2_32/lightning_logs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]

  | Name  | Type              | Params
--------------------------------------------
0 | model | MEGNet            | 164 K 
1 | mae   | MeanAbsoluteError | 0     
2 | rmse  | MeanSquaredError  | 0     
--------------------------------------------
164 K     Trainable params
25        Non-trainable params
164 K     Total params
0.656     Total estimated model params size (MB)
`Trainer.fit` stopped: `max_epochs=1000` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test_MAE            23.244335174560547
        test_RMSE           53.268890380859375
     test_Total_Loss        23.244335174560547
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
2024-04-26 22:31:19 INFO     Loading dataset 'matbench_phonons'...
2024-04-26 22:31:20 INFO     Dataset 'matbench_phonons loaded.
  0%|          | 0/1012 [00:00<?, ?it/s]  5%|▌         | 55/1012 [00:00<00:01, 545.85it/s] 12%|█▏        | 126/1012 [00:00<00:01, 640.83it/s] 20%|██        | 203/1012 [00:00<00:01, 699.14it/s] 28%|██▊       | 283/1012 [00:00<00:00, 736.69it/s] 36%|███▌      | 361/1012 [00:00<00:00, 750.97it/s] 43%|████▎     | 437/1012 [00:00<00:00, 753.15it/s] 51%|█████     | 513/1012 [00:00<00:00, 724.57it/s] 58%|█████▊    | 587/1012 [00:00<00:00, 728.30it/s] 66%|██████▌   | 664/1012 [00:00<00:00, 740.90it/s] 73%|███████▎  | 739/1012 [00:01<00:00, 734.35it/s] 80%|████████  | 813/1012 [00:01<00:00, 728.93it/s] 88%|████████▊ | 887/1012 [00:01<00:00, 731.22it/s] 95%|█████████▍| 961/1012 [00:01<00:00, 422.05it/s]100%|██████████| 1012/1012 [00:01<00:00, 616.82it/s]
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Missing logger folder: matbench_phonons_2_32/lightning_logs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]

  | Name  | Type              | Params
--------------------------------------------
0 | model | MEGNet            | 164 K 
1 | mae   | MeanAbsoluteError | 0     
2 | rmse  | MeanSquaredError  | 0     
--------------------------------------------
164 K     Trainable params
25        Non-trainable params
164 K     Total params
0.656     Total estimated model params size (MB)
`Trainer.fit` stopped: `max_epochs=1000` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test_MAE             14.79390811920166
        test_RMSE           24.919755935668945
     test_Total_Loss         14.79390811920166
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
2024-04-26 23:20:22 INFO     Loading dataset 'matbench_dielectric'...
2024-04-26 23:20:27 INFO     Dataset 'matbench_dielectric loaded.
  0%|          | 0/3811 [00:00<?, ?it/s]  1%|▏         | 53/3811 [00:00<00:07, 529.31it/s]  3%|▎         | 106/3811 [00:00<00:08, 459.84it/s]  4%|▍         | 157/3811 [00:00<00:07, 475.27it/s]  6%|▌         | 219/3811 [00:00<00:06, 527.94it/s]  7%|▋         | 283/3811 [00:00<00:06, 564.16it/s]  9%|▉         | 340/3811 [00:00<00:06, 551.76it/s] 10%|█         | 396/3811 [00:00<00:06, 531.98it/s] 12%|█▏        | 450/3811 [00:00<00:06, 530.02it/s] 13%|█▎        | 504/3811 [00:00<00:06, 511.52it/s] 15%|█▍        | 557/3811 [00:01<00:06, 515.98it/s] 16%|█▌        | 610/3811 [00:01<00:06, 519.87it/s] 17%|█▋        | 666/3811 [00:01<00:05, 530.59it/s] 19%|█▉        | 720/3811 [00:01<00:05, 520.44it/s] 20%|██        | 773/3811 [00:01<00:06, 506.03it/s] 22%|██▏       | 824/3811 [00:01<00:05, 504.29it/s] 23%|██▎       | 885/3811 [00:01<00:05, 534.64it/s] 25%|██▍       | 939/3811 [00:01<00:05, 529.26it/s] 26%|██▌       | 993/3811 [00:01<00:05, 522.01it/s] 27%|██▋       | 1046/3811 [00:02<00:05, 473.66it/s] 29%|██▉       | 1103/3811 [00:02<00:05, 499.52it/s] 30%|███       | 1154/3811 [00:02<00:05, 478.50it/s] 32%|███▏      | 1203/3811 [00:02<00:05, 480.46it/s] 33%|███▎      | 1252/3811 [00:02<00:05, 480.66it/s] 34%|███▍      | 1301/3811 [00:02<00:05, 441.69it/s] 36%|███▌      | 1356/3811 [00:02<00:05, 470.78it/s] 37%|███▋      | 1417/3811 [00:02<00:04, 508.69it/s] 39%|███▉      | 1484/3811 [00:02<00:04, 552.83it/s] 41%|████      | 1550/3811 [00:02<00:03, 582.62it/s] 42%|████▏     | 1618/3811 [00:03<00:03, 609.62it/s] 44%|████▍     | 1683/3811 [00:03<00:03, 620.61it/s] 46%|████▌     | 1746/3811 [00:03<00:03, 587.39it/s] 47%|████▋     | 1806/3811 [00:03<00:03, 571.85it/s] 49%|████▉     | 1864/3811 [00:03<00:03, 573.68it/s] 50%|█████     | 1922/3811 [00:03<00:03, 533.72it/s] 52%|█████▏    | 1977/3811 [00:03<00:03, 482.93it/s] 53%|█████▎    | 2030/3811 [00:03<00:03, 494.28it/s] 55%|█████▍    | 2086/3811 [00:04<00:03, 510.47it/s] 56%|█████▌    | 2138/3811 [00:04<00:03, 507.06it/s] 58%|█████▊    | 2197/3811 [00:04<00:03, 529.73it/s] 59%|█████▉    | 2251/3811 [00:04<00:02, 522.08it/s] 61%|██████    | 2310/3811 [00:04<00:02, 541.14it/s] 62%|██████▏   | 2365/3811 [00:04<00:02, 503.87it/s] 63%|██████▎   | 2417/3811 [00:04<00:03, 459.34it/s] 65%|██████▍   | 2465/3811 [00:04<00:03, 432.80it/s] 66%|██████▌   | 2510/3811 [00:04<00:03, 426.76it/s] 67%|██████▋   | 2558/3811 [00:05<00:02, 439.95it/s] 69%|██████▊   | 2614/3811 [00:05<00:02, 471.90it/s] 70%|███████   | 2675/3811 [00:05<00:02, 510.26it/s] 72%|███████▏  | 2727/3811 [00:05<00:02, 509.82it/s] 73%|███████▎  | 2779/3811 [00:05<00:02, 485.49it/s] 74%|███████▍  | 2829/3811 [00:05<00:02, 485.42it/s] 76%|███████▌  | 2878/3811 [00:05<00:02, 460.53it/s] 77%|███████▋  | 2929/3811 [00:05<00:01, 472.93it/s] 78%|███████▊  | 2977/3811 [00:05<00:01, 436.02it/s] 79%|███████▉  | 3027/3811 [00:05<00:01, 452.90it/s] 81%|████████  | 3078/3811 [00:06<00:01, 468.10it/s] 82%|████████▏ | 3140/3811 [00:06<00:01, 508.60it/s] 84%|████████▍ | 3200/3811 [00:06<00:01, 533.96it/s] 86%|████████▌ | 3262/3811 [00:06<00:00, 557.20it/s] 87%|████████▋ | 3322/3811 [00:06<00:00, 569.64it/s] 89%|████████▉ | 3383/3811 [00:06<00:00, 580.48it/s] 90%|█████████ | 3442/3811 [00:06<00:00, 565.84it/s] 92%|█████████▏| 3499/3811 [00:06<00:00, 533.75it/s] 93%|█████████▎| 3553/3811 [00:06<00:00, 487.02it/s] 95%|█████████▍| 3603/3811 [00:07<00:00, 474.46it/s] 96%|█████████▌| 3658/3811 [00:07<00:00, 493.31it/s] 98%|█████████▊| 3729/3811 [00:07<00:00, 553.10it/s]100%|█████████▉| 3796/3811 [00:07<00:00, 584.69it/s]100%|██████████| 3811/3811 [00:07<00:00, 513.98it/s]
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Missing logger folder: matbench_dielectric_2_32/lightning_logs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [2]

  | Name  | Type              | Params
--------------------------------------------
0 | model | MEGNet            | 164 K 
1 | mae   | MeanAbsoluteError | 0     
2 | rmse  | MeanSquaredError  | 0     
--------------------------------------------
164 K     Trainable params
25        Non-trainable params
164 K     Total params
0.656     Total estimated model params size (MB)
Traceback (most recent call last):
  File "/home/liuxiaotong/chtt/megnet_emb_2_1/megnet_orig.py", line 164, in <module>
    trainer.fit(model=lit_module, train_dataloaders=train_loader)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1033, in _run_stage
    self.fit_loop.run()
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 206, in run
    self.on_advance_end()
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 378, in on_advance_end
    call._call_callback_hooks(trainer, "on_train_epoch_end", monitoring_callbacks=True)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 208, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 324, in on_train_epoch_end
    self._save_topk_checkpoint(trainer, monitor_candidates)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 386, in _save_topk_checkpoint
    self._save_none_monitor_checkpoint(trainer, monitor_candidates)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 714, in _save_none_monitor_checkpoint
    self._save_checkpoint(trainer, filepath)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py", line 389, in _save_checkpoint
    trainer.save_checkpoint(filepath, self.save_weights_only)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1381, in save_checkpoint
    self.strategy.save_checkpoint(checkpoint, filepath, storage_options=storage_options)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 491, in save_checkpoint
    self.checkpoint_io.save_checkpoint(checkpoint, filepath, storage_options=storage_options)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/lightning_fabric/plugins/io/torch_io.py", line 58, in save_checkpoint
    _atomic_save(checkpoint, path)
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/lightning_fabric/utilities/cloud_io.py", line 80, in _atomic_save
    f.write(bytesbuffer.getvalue())
  File "/home/liuxiaotong/anaconda3/envs/pl_124/lib/python3.10/site-packages/fsspec/implementations/local.py", line 389, in write
    return self.f.write(*args, **kwargs)
OSError: [Errno 28] No space left on device
